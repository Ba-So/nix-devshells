{
  "master": {
    "tasks": [
      {
        "id": 1,
        "title": "Add Python development shell",
        "description": "Create a Nix development shell configuration for Python projects with common dependencies",
        "details": "",
        "testStrategy": "",
        "status": "in-progress",
        "dependencies": [],
        "priority": "high",
        "subtasks": [
          {
            "id": 1,
            "title": "Define Python package dependencies",
            "description": "List common Python packages like pip, virtualenv, pytest",
            "details": "",
            "status": "done",
            "dependencies": [],
            "parentTaskId": 1,
            "updatedAt": "2025-12-02T09:28:53.788Z",
            "parentId": "undefined"
          },
          {
            "id": 2,
            "title": "Create flake.nix for Python shell",
            "description": "Write the Nix flake configuration",
            "details": "<info added on 2025-12-02T11:37:32.573Z>\nI'll analyze the codebase to understand the existing patterns and provide accurate implementation guidance.Based on my analysis of the codebase, here's the specific implementation guidance for the Python shell:\n\nCreated flake.nix configuration following the established module-based architecture. The Python module at modules/languages/python.nix (lines 15-61) provides the complete package set including python312, uv, pytest, pytest-cov, pytest-xdist, pytest-asyncio, ruff, mypy, bandit, and comprehensive development tools. The module follows the standard pattern with meta, packages, shellHook, and suggestedMcps fields. Integration follows default.nix pattern (line 51-54) where Python shell is composed using libSystem.composeShell with languages=[\"python\"] and tools=\"standard\". The flake.nix at line 55 exposes the python devShell alongside other language environments (rust, php, nix, cpp, latex, ansible, julia). No need to create a standalone flake.nix - the Python module is already integrated into the modular system. To enable the Python shell, it should be added to flake.nix line 55 devShells output (already present as 'python'). The module includes virtualenv functionality through uv (replaces legacy pip/virtualenv), with shellHook providing environment setup (lines 63-150) including UV_PYTHON configuration, library paths for C extensions, and helpful command documentation. Dependencies include system libraries (zlib, openssl, libffi, postgresql, mysql80) for common Python packages with C extensions.\n</info added on 2025-12-02T11:37:32.573Z>",
            "status": "pending",
            "dependencies": [],
            "parentTaskId": 1,
            "parentId": "undefined"
          }
        ],
        "updatedAt": "2025-12-02T09:28:53.788Z"
      },
      {
        "id": 2,
        "title": "Add Rust development shell",
        "description": "Create a Nix development shell for Rust projects with cargo and rustc",
        "details": "",
        "testStrategy": "",
        "status": "pending",
        "dependencies": [
          "1"
        ],
        "priority": "medium",
        "subtasks": []
      },
      {
        "id": 3,
        "title": "Add Node.js development shell",
        "description": "Create a Nix development shell for Node.js projects with npm, yarn, pnpm, and comprehensive JavaScript/TypeScript tooling",
        "details": "Create `modules/languages/nodejs.nix` following the established module pattern (see python.nix, rust.nix, julia.nix for reference):\n\n**Module Structure:**\n```nix\n{ pkgs, inputs, lib, }:\n{\n  meta = {\n    name = \"nodejs\";\n    description = \"Node.js development environment with package managers and tooling\";\n    category = \"language\";\n  };\n\n  packages = [\n    # Core Node.js runtime (LTS version)\n    pkgs.nodejs_20  # Or nodejs_22 for latest LTS\n    \n    # Package managers\n    pkgs.nodePackages.npm\n    pkgs.yarn\n    pkgs.nodePackages.pnpm\n    \n    # Development tools\n    pkgs.nodePackages.typescript\n    pkgs.nodePackages.ts-node\n    pkgs.nodePackages.typescript-language-server\n    \n    # Linting and formatting\n    pkgs.nodePackages.eslint\n    pkgs.nodePackages.prettier\n    pkgs.biome  # Fast alternative to ESLint/Prettier\n    \n    # Testing frameworks\n    pkgs.nodePackages.jest\n    pkgs.nodePackages.vitest\n    pkgs.nodePackages.mocha\n    \n    # Build tools\n    pkgs.nodePackages.webpack\n    pkgs.nodePackages.webpack-cli\n    pkgs.nodePackages.vite\n    pkgs.nodePackages.esbuild\n    \n    # Utilities\n    pkgs.nodePackages.nodemon  # Auto-restart on changes\n    pkgs.nodePackages.npm-check-updates  # Update dependencies\n    pkgs.nodePackages.npm-check  # Check for unused/missing deps\n    pkgs.nodePackages.node-gyp  # Native addon build tool\n    \n    # Documentation\n    pkgs.nodePackages.jsdoc\n    pkgs.nodePackages.typedoc\n  ];\n\n  shellHook = ''\n    echo \"ðŸŸ¢ Node.js development environment ready!\"\n    echo \"   node --version: $(node --version)\"\n    echo \"   npm --version: $(npm --version)\"\n    echo \"   yarn --version: $(yarn --version 2>/dev/null || echo 'not installed')\"\n    echo \"   pnpm --version: $(pnpm --version 2>/dev/null || echo 'not installed')\"\n    echo \"\"\n    \n    # Set up npm/yarn/pnpm cache directories\n    export NPM_CONFIG_CACHE=\"$HOME/.cache/npm\"\n    export YARN_CACHE_FOLDER=\"$HOME/.cache/yarn\"\n    export PNPM_HOME=\"$HOME/.cache/pnpm\"\n    mkdir -p \"$NPM_CONFIG_CACHE\" \"$YARN_CACHE_FOLDER\" \"$PNPM_HOME\"\n    \n    # Detect package manager from lockfile\n    if [ -f \"pnpm-lock.yaml\" ]; then\n      PKG_MGR=\"pnpm\"\n    elif [ -f \"yarn.lock\" ]; then\n      PKG_MGR=\"yarn\"\n    elif [ -f \"package-lock.json\" ]; then\n      PKG_MGR=\"npm\"\n    else\n      PKG_MGR=\"npm\"\n    fi\n    \n    echo \"ðŸ“¦ Package manager: $PKG_MGR (detected from lockfile)\"\n    echo \"   Cache locations configured\"\n    echo \"\"\n    \n    # Check for package.json\n    if [ -f \"package.json\" ]; then\n      echo \"ðŸ“¦ Node.js project detected (package.json found)\"\n      if [ ! -d \"node_modules\" ]; then\n        echo \"   Run '$PKG_MGR install' to install dependencies\"\n      else\n        echo \"   Dependencies installed in node_modules/\"\n      fi\n      echo \"\"\n    fi\n    \n    echo \"ðŸ”§ Development tools:\"\n    echo \"   âœ… TypeScript compiler and language server\"\n    echo \"   âœ… ESLint, Prettier, Biome for code quality\"\n    echo \"   âœ… Jest, Vitest, Mocha for testing\"\n    echo \"   âœ… Webpack, Vite, esbuild for bundling\"\n    echo \"\"\n    \n    echo \"ðŸ’¡ Quick commands:\"\n    echo \"   npm init / yarn init           # Initialize new project\"\n    echo \"   npm install / yarn             # Install dependencies\"\n    echo \"   npm run <script>               # Run package.json script\"\n    echo \"   npx <package>                  # Execute package binary\"\n    echo \"\"\n    \n    echo \"ðŸ§ª Testing:\"\n    echo \"   npm test                       # Run tests\"\n    echo \"   npx jest --watch               # Run Jest in watch mode\"\n    echo \"   npx vitest                     # Run Vitest\"\n    echo \"\"\n    \n    echo \"ðŸŽ¨ Code quality:\"\n    echo \"   npx eslint .                   # Lint JavaScript/TypeScript\"\n    echo \"   npx prettier --write .         # Format code\"\n    echo \"   npx biome check .              # Fast all-in-one linting/formatting\"\n    echo \"   npx tsc --noEmit               # Type check TypeScript\"\n    echo \"\"\n    \n    echo \"ðŸ“¦ Package management:\"\n    echo \"   npm outdated                   # Check for outdated packages\"\n    echo \"   npx npm-check-updates -u       # Update package.json dependencies\"\n    echo \"   npm audit                      # Security vulnerability scan\"\n    echo \"   npm prune                      # Remove unused packages\"\n    echo \"\"\n  '';\n\n  env = {\n    NODE_ENV = \"development\";\n  };\n\n  suggestedMcps = [\"serena\"];\n}\n```\n\n**Register the module:**\nUpdate `modules/languages/default.nix` to include:\n```nix\nnodejs = import ./nodejs.nix {inherit pkgs inputs lib;};\n```\n\n**Create template (optional):**\nCreate `templates/nodejs/flake.nix` similar to existing templates (rust, python, php) for quick project initialization with `nix flake init -t github:Ba-So/nix-devshells#nodejs`.\n\n**Update documentation:**\nAdd nodejs to the list of available devShells in README.md under \"Pre-Built\" section.",
        "testStrategy": "1. Build the module: `nix build .#devShells.x86_64-linux.nodejs` or enter the shell with `nix develop .#nodejs`\n2. Verify all tools are available:\n   - `node --version` (should show Node.js version)\n   - `npm --version`, `yarn --version`, `pnpm --version`\n   - `tsc --version`, `eslint --version`, `prettier --version`\n   - `biome --version`, `jest --version`, `vite --version`\n3. Test package manager detection:\n   - Create test directories with different lockfiles (package-lock.json, yarn.lock, pnpm-lock.yaml)\n   - Verify correct package manager is detected in shellHook output\n4. Test composition with other languages: `nix develop` with a flake using `composeShell { languages = [\"nodejs\" \"python\"]; }`\n5. Create a simple TypeScript project and verify:\n   - `npm install` works correctly\n   - `npx tsc` compiles TypeScript\n   - `npx jest` runs tests\n   - Tools use configured cache directories ($HOME/.cache/npm, etc.)\n6. Verify the module follows the established pattern by comparing with python.nix and rust.nix structure",
        "status": "pending",
        "dependencies": [
          1
        ],
        "priority": "medium",
        "subtasks": [
          {
            "id": 1,
            "title": "Create nodejs.nix module with packages and configuration",
            "description": "Create the core Node.js module file at modules/languages/nodejs.nix with all required packages, shellHook, and metadata following the established pattern from python.nix, rust.nix, and julia.nix",
            "dependencies": [],
            "details": "Create modules/languages/nodejs.nix with:\n- meta section (name: nodejs, description, category: language)\n- packages array including:\n  * Core: pkgs.nodejs_20 (LTS)\n  * Package managers: npm, yarn, pnpm (via pkgs.nodePackages)\n  * TypeScript tooling: typescript, ts-node, typescript-language-server\n  * Linting/formatting: eslint, prettier, pkgs.biome\n  * Testing: jest, vitest, mocha\n  * Build tools: webpack, webpack-cli, vite, esbuild\n  * Utilities: nodemon, npm-check-updates, npm-check, node-gyp\n  * Documentation: jsdoc, typedoc\n- shellHook with:\n  * Version information display (node, npm, yarn, pnpm)\n  * Cache directory setup (NPM_CONFIG_CACHE, YARN_CACHE_FOLDER, PNPM_HOME)\n  * Package manager detection from lockfiles (pnpm-lock.yaml â†’ pnpm, yarn.lock â†’ yarn, package-lock.json â†’ npm)\n  * package.json/node_modules detection and guidance\n  * Detailed help sections for: Quick commands, Testing, Code quality, Package management\n- env section with NODE_ENV=\"development\"\n- suggestedMcps = [\"serena\"]\n\nFollow the exact structure and style of julia.nix (lines 1-115) for consistency.",
            "status": "pending",
            "testStrategy": "Build the devShell with `nix build .#devShells.x86_64-linux.nodejs` or enter with `nix develop .#nodejs`. Verify:\n1. All packages are available in PATH\n2. Version commands work: node --version, npm --version, yarn --version, pnpm --version, tsc --version\n3. shellHook displays correctly with all sections\n4. Cache directories are created\n5. Package manager detection works (test with dummy lockfiles)"
          },
          {
            "id": 2,
            "title": "Register nodejs module in default.nix",
            "description": "Add the nodejs module to modules/languages/default.nix so it can be discovered and used by the composition system",
            "dependencies": [
              1
            ],
            "details": "Edit modules/languages/default.nix (currently 15 lines):\n- Add line after julia import (line 14): nodejs = import ./nodejs.nix {inherit pkgs inputs lib;};\n- Follow the exact pattern used for other language modules\n- Maintain alphabetical ordering is not required based on existing file (rust, python, cpp, nix, php, latex, ansible, julia order)\n- Simply append after julia entry before closing brace",
            "status": "pending",
            "testStrategy": "Verify module registration:\n1. Check that `nix flake show` includes nodejs in devShells outputs\n2. Test direct access: `nix develop .#nodejs`\n3. Verify composition API works: create test flake.nix with composeShell { languages = [\"nodejs\"]; } and test it builds"
          },
          {
            "id": 3,
            "title": "Create nodejs template flake.nix",
            "description": "Create a templates/nodejs/flake.nix template file for quick Node.js project initialization following the rust template pattern",
            "dependencies": [
              2
            ],
            "details": "Create templates/nodejs/ directory and flake.nix file based on templates/rust/flake.nix structure:\n- Use description: \"My Node.js Project\"\n- Include same inputs: nixpkgs (nixos-unstable), flake-utils, devshells\n- In outputs, provide devShells.default using composeShell with languages = [\"nodejs\"]\n- Include commented examples for:\n  * Minimal shell (tools = \"minimal\", mcps = [])\n  * Extended shell with extraPackages (example: postgresql for pg clients, redis-cli)\n  * Direct module composition example\n  * OLD API reference for migration\n- Add Node.js specific comments for:\n  * package.json scripts integration\n  * Common Node.js development tools to add (e.g., postgres client packages)\n  * Environment variables (NODE_ENV, DATABASE_URL examples)\n- Match the style and comprehensiveness of rust template (109 lines)",
            "status": "pending",
            "testStrategy": "Test template initialization:\n1. Create test directory: mkdir -p /tmp/test-nodejs-template && cd /tmp/test-nodejs-template\n2. Initialize: nix flake init -t /home/baso/dev/nix-devshells#nodejs\n3. Verify flake.nix was created\n4. Test build: nix develop\n5. Verify all tools are available in the shell\n6. Test commented examples by uncommenting and building"
          },
          {
            "id": 4,
            "title": "Register nodejs template in flake.nix templates section",
            "description": "Add nodejs template to the templates output section in the root flake.nix so users can initialize projects with `nix flake init -t`",
            "dependencies": [
              3
            ],
            "details": "Edit the root flake.nix file:\n1. Locate the templates output section (search for 'templates = {')\n2. Add nodejs entry following the pattern of existing templates:\n   nodejs = {\n     path = ./templates/nodejs;\n     description = \"Node.js development environment with npm, yarn, pnpm, and TypeScript tooling\";\n   };\n3. Maintain consistency with other template descriptions (rust, php, latex, cpp)\n4. Place after julia or in logical order (language templates grouped together)",
            "status": "pending",
            "testStrategy": "Verify template registration:\n1. Run `nix flake show` and confirm nodejs appears in templates section\n2. Test initialization from GitHub: nix flake init -t github:Ba-So/nix-devshells#nodejs (in clean directory)\n3. Verify the initialized template works: nix develop\n4. Check description appears in flake show output"
          },
          {
            "id": 5,
            "title": "Update README.md documentation",
            "description": "Add nodejs to the Pre-Built devShells list in README.md and verify all documentation is consistent",
            "dependencies": [
              4
            ],
            "details": "Edit README.md:\n1. Locate the \"Pre-Built:\" section under \"### DevShells\" (around line 25-35)\n2. Add nodejs entry in logical position (suggest after python, before latex):\n   - `nodejs` - Node.js 20 LTS, npm, yarn, pnpm, TypeScript tooling\n3. Maintain the existing format: `name` - Brief description of key features\n4. Ensure consistency with module's meta.description\n5. Verify templates section (line ~59-64) is updated if it exists\n6. Consider adding nodejs to example compositions if appropriate\n\nKeep the description concise (under 10 words) matching the style of other entries.",
            "status": "pending",
            "testStrategy": "Documentation verification:\n1. Read through README.md to ensure nodejs is mentioned in appropriate sections\n2. Verify the description matches the module's capabilities\n3. Check formatting consistency with other entries\n4. Test any example commands mentioned in the README\n5. Verify all cross-references (if nodejs is mentioned in multiple places) are consistent"
          }
        ]
      }
    ],
    "metadata": {
      "version": "1.0.0",
      "lastModified": "2025-12-02T09:28:53.789Z",
      "taskCount": 2,
      "completedCount": 0,
      "tags": [
        "master"
      ],
      "created": "2025-12-02T11:35:29.359Z",
      "description": "Tasks for master context",
      "updated": "2025-12-02T11:36:48.693Z"
    }
  }
}
